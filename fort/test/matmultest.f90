program matmultest
    use, intrinsic :: iso_fortran_env, only: dp => real64, qp => real128
    implicit none
    integer, parameter :: wp = dp
    integer i
    real(wp)           :: K(13,6), E5(13), err5(6), scal(6), err5_test(6)
    K(1,:)  = [-2.956795170934981_wp,  1.8105148709099377e-16_wp, 8.123727966096327_wp, -3.8136314567463637e-19_wp, -0.0062281328124999995_wp, -0.0_wp]
    K(2,:)  = [-2.956795170934981_wp, -6.563327647898372e-12_wp,  8.123727966096327_wp,  2.4254874901959096e-15_wp, -0.0062281328124999995_wp, -6.665019897114277e-15_wp]
    K(3,:)  = [-2.956795170934981_wp, -9.845081997591104e-12_wp,  8.123727966096327_wp,  3.638421916866702e-15_wp,  -0.0062281328124999995_wp, -9.997529845671416e-15_wp]
    K(4,:)  = [-2.956795170934981_wp, -1.47677135221302e-11_wp,   8.123727966096327_wp,  5.45782355687289e-15_wp,   -0.0062281328124999995_wp, -1.4996294768507124e-14_wp]
    K(5,:)  = [-2.956795170934981_wp, -3.5144393863808684e-11_wp, 8.123727966096327_wp,  1.2989032311117973e-14_wp, -0.0062281328124999995_wp, -3.568812076199447e-14_wp]
    K(6,:)  = [-2.956795170934981_wp, -4.1593543522607126e-11_wp, 8.123727966096327_wp,  1.5372634132089506e-14_wp, -0.0062281328124999995_wp, -4.223701294208465e-14_wp]
    K(7,:)  = [-2.956795170934981_wp, -3.119511237908358e-11_wp,  8.123727966096327_wp,  1.1529380258280711e-14_wp, -0.0062281328124999995_wp, -3.167775970656349e-14_wp]
    K(8,:)  = [-2.956795170934981_wp, -3.8394026247676804e-11_wp, 8.123727966096327_wp,  1.4190094478609873e-14_wp, -0.0062281328124999995_wp, -3.898801194653969e-14_wp]
    K(9,:)  = [-2.956795170934981_wp, -8.126755773174293e-11_wp,  8.123727966096327_wp,  3.003612583523705e-14_wp,  -0.0062281328124999995_wp, -8.25246252868427e-14_wp]
    K(10,:) = [-2.956795170934981_wp, -7.486852318188223e-11_wp,  8.123727966096327_wp,  2.767104652827767e-14_wp,  -0.0062281328124999995_wp, -7.602662329575227e-14_wp]
    K(11,:) = [-2.956795170934981_wp, -1.0695511071046956e-10_wp, 8.123727966096327_wp,  3.953022991031627e-14_wp,  -0.0062281328124999995_wp, -1.0860946185107481e-13_wp]
    K(12,:) = [-2.956795170934981_wp, -1.2478099267079556e-10_wp, 8.123727966096327_wp,  4.611866512255984e-14_wp,  -0.0062281328124999995_wp, -1.2671103882625412e-13_wp]
    K(13,:) = [-2.956795170934981_wp, -1.2478099267079564e-10_wp, 8.123727966096327_wp,  4.611866512255986e-14_wp,  -0.0062281328124999995_wp, -1.2671103882625402e-13_wp]
    E5 = [ &
          0.1312004499419488073250102996e-1_WP, &
          0._WP, &
          0._WP, &
          0._WP, &
          0._WP, &
         -0.1225156446376204440720569753e+1_WP, &
         -0.4957589496572501915214079952_WP, &
          0.1664377182454986536961530415e+1_WP, &
         -0.3503288487499736816886487290_WP, &
          0.3341791187130174790297318841_WP, &
          0.8192320648511571246570742613e-1_WP, &
         -0.2235530786388629525884427845e-1_WP, &
          0._WP &
         ]

    err5 = [-3.48602399e+03_wp,  6.56332273e-18_wp,  &
             1.69009709e+04_wp, -1.46737754e-16_wp, &
            -7.57995686e+01_wp,  1.91298376e-16_wp]
    scal = [1.59239150E-20_wp,   8.00000011E-10_wp,   &
             2.62759592E-20_wp,   2.95679334E-13_wp,   &
             1.00124785E-20_wp, 8.12372305E-13_wp]
    ! do i = 1, 13
    !     K(i,:) = K(i,:)/scal
    ! end do

    err5_test = matmul(transpose(K), E5)/ scal
    print *, "err5_test"
    print *, err5_test
    print *, "K.T@E5"
    print *, matmul(transpose(K),E5)
    print *, "sume5"
    print *, sum(E5)
    print *, "sumK"
    print *, sum(K)
end program
